<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>KKT solvers · Tulip.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Tulip.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../../tutorials/lp_example/">Toy example</a></li></ul></li><li><span class="tocitem">User manual</span><ul><li><a class="tocitem" href="../../../manual/formulation/">Problem formulation</a></li><li><a class="tocitem" href="../../../manual/linear_systems/">Solving linear systems</a></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../manual/IPM/HSD/">Homogeneous Self-Dual</a></li><li><a class="tocitem" href="../../../manual/IPM/MPC/">Predictor-Corrector</a></li></ul></li><li><a class="tocitem" href="../../../manual/options/">Setting options</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../Presolve/presolve/">Presolve</a></li><li class="is-active"><a class="tocitem" href>KKT solvers</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Dense/LAPACK"><span>Dense/LAPACK</span></a></li><li><a class="tocitem" href="#CHOLMOD"><span>CHOLMOD</span></a></li><li><a class="tocitem" href="#LDLFactorizations"><span>LDLFactorizations</span></a></li><li><a class="tocitem" href="#Krylov"><span>Krylov</span></a></li></ul></li><li><a class="tocitem" href="../../API/">Julia API</a></li><li><a class="tocitem" href="../../attributes/">Attributes</a></li><li><a class="tocitem" href="../../options/">Options</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>KKT solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>KKT solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ds4dm/Tulip.jl/blob/master/docs/src/reference/KKT/kkt_solvers.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><h3 id="AbstractKKTSolver"><a class="docs-heading-anchor" href="#AbstractKKTSolver">AbstractKKTSolver</a><a id="AbstractKKTSolver-1"></a><a class="docs-heading-anchor-permalink" href="#AbstractKKTSolver" title="Permalink"></a></h3><p>This is the base type from which all implementations should derive.</p><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.AbstractKKTSolver" href="#Tulip.KKT.AbstractKKTSolver"><code>Tulip.KKT.AbstractKKTSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AbstractKKTSolver{T}</code></pre><p>Abstract container for solving an augmented system</p><pre><code class="nohighlight">    [-(Θ⁻¹ + Rp)   Aᵀ] [dx] = [ξd]
    [   A          Rd] [dy]   [ξp]</code></pre><p>where <code>ξd</code> and <code>ξp</code> are given right-hand side.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/KKT.jl#L9-L18">source</a></section></article><p>Custom linear solvers should inherit from the <code>AbstractKKTSolver</code> class, and extend the following two functions:</p><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.update!" href="#Tulip.KKT.update!"><code>Tulip.KKT.update!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">update!(kkt, θinv, regP, regD)</code></pre><p>Update internal data and factorization/pre-conditioner.</p><p>After this call, <code>kkt</code> can be used to solve the augmented system</p><pre><code class="nohighlight">    [-(Θ⁻¹ + Rp)   Aᵀ] [dx] = [ξd]
    [   A          Rd] [dy]   [ξp]</code></pre><p>for given right-hand sides <code>ξd</code> and <code>ξp</code>.</p><p><strong>Arguments</strong></p><ul><li><code>kkt::AbstractKKTSolver{T}</code>: the KKT solver object</li><li><code>θinv::AbstractVector{T}</code>: <span>$θ⁻¹$</span></li><li><code>regP::AbstractVector{T}</code>: primal regularizations</li><li><code>regD::AbstractVector{T}</code>: dual regularizations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/KKT.jl#L44-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.solve!" href="#Tulip.KKT.solve!"><code>Tulip.KKT.solve!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">solve!(dx, dy, kkt, ξp, ξd)</code></pre><p>Solve the symmetric quasi-definite augmented system</p><pre><code class="nohighlight">    [-(Θ⁻¹ + Rp)   Aᵀ] [dx] = [ξd]
    [   A          Rd] [dy]   [ξp]</code></pre><p>and over-write <code>dx</code>, <code>dy</code> with the result.</p><p><strong>Arguments</strong></p><ul><li><code>dx, dy</code>: Vectors of unknowns, modified in-place</li><li><code>kkt</code>: Linear solver for the augmented system</li><li><code>ξp, ξd</code>: Right-hand-side vectors</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/KKT.jl#L65-L79">source</a></section></article><h3 id="Choosing-between-linear-solvers"><a class="docs-heading-anchor" href="#Choosing-between-linear-solvers">Choosing between linear solvers</a><a id="Choosing-between-linear-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Choosing-between-linear-solvers" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.KKTOptions" href="#Tulip.KKT.KKTOptions"><code>Tulip.KKT.KKTOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">KKTOptions{T}</code></pre><p>KKT solver options.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/KKT.jl#L21-L25">source</a></section></article><h2 id="Dense/LAPACK"><a class="docs-heading-anchor" href="#Dense/LAPACK">Dense/LAPACK</a><a id="Dense/LAPACK-1"></a><a class="docs-heading-anchor-permalink" href="#Dense/LAPACK" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.DenseSPD" href="#Tulip.KKT.DenseSPD"><code>Tulip.KKT.DenseSPD</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DenseSPD{T}</code></pre><p>KKT solver for dense linear systems.</p><p>Uses a Cholesky factorization of the normal equations system. Not recommended     for systems of size larger than a few thousands.</p><pre><code class="language-julia">model = Tulip.Model{Float64}()
model.params.KKT.Factory = Tulip.Factory(Tulip.KKT.DenseSPD)</code></pre><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Dispatches to BLAS/LAPACK in <code>Float32</code> and <code>Float64</code> arithmetic.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/lapack.jl#L5-L20">source</a></section></article><h2 id="CHOLMOD"><a class="docs-heading-anchor" href="#CHOLMOD">CHOLMOD</a><a id="CHOLMOD-1"></a><a class="docs-heading-anchor-permalink" href="#CHOLMOD" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.CholmodSolver" href="#Tulip.KKT.CholmodSolver"><code>Tulip.KKT.CholmodSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">CholmodSolver</code></pre><p>Uses CHOLMOD&#39;s factorization routines to solve the augmented system.</p><p>To use an LDLᵀ factorization of the augmented system (see <a href="#Tulip.KKT.CholmodSQD"><code>CholmodSQD</code></a>)</p><pre><code class="language-julia">model.params.KKT.Factory = Tulip.Factory(CholmodSolver, normal_equations=false)</code></pre><p>To use a Cholesky factorization of the normal equations system (see <a href="#Tulip.KKT.CholmodSPD"><code>CholmodSPD</code></a>)</p><pre><code class="language-julia">model.params.KKT.Factory = Tulip.Factory(CholmodSolver, normal_equations=true)</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>CHOLMOD can only be used with <code>Float64</code> arithmetic.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/cholmod.jl#L4-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.CholmodSQD" href="#Tulip.KKT.CholmodSQD"><code>Tulip.KKT.CholmodSQD</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">CholmodSQD</code></pre><p>Linear solver for the 2x2 augmented system with <span>$A$</span> sparse.</p><p>Uses an LDLᵀ factorization of the quasi-definite augmented system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/cholmod.jl#L43-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.CholmodSPD" href="#Tulip.KKT.CholmodSPD"><code>Tulip.KKT.CholmodSPD</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">CholmodSPD</code></pre><p>Linear solver for the 2x2 augmented system</p><pre><code class="nohighlight">    [-(Θ⁻¹ + Rp)   Aᵀ] [dx] = [ξd]
    [   A          Rd] [dy]   [ξp]</code></pre><p>with <span>$A$</span> sparse.</p><p>Uses a Cholesky factorization of the positive definite normal equations system</p><pre><code class="nohighlight">(A * ((Θ⁻¹ + Rp)⁻¹ * Aᵀ + Rd) dy = ξp + A * (θ⁻¹ + Rp)⁻¹ * ξd
                              dx = (Θ⁻¹ + Rp)⁻¹ * (Aᵀ * dy - ξd)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/cholmod.jl#L197-L212">source</a></section></article><h2 id="LDLFactorizations"><a class="docs-heading-anchor" href="#LDLFactorizations">LDLFactorizations</a><a id="LDLFactorizations-1"></a><a class="docs-heading-anchor-permalink" href="#LDLFactorizations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.LDLFactSQD" href="#Tulip.KKT.LDLFactSQD"><code>Tulip.KKT.LDLFactSQD</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">LDLFactSQD{T}</code></pre><p>Linear solver for the 2x2 augmented system with <span>$A$</span> sparse.</p><p>Uses LDLFactorizations.jl to compute an LDLᵀ factorization of the quasi-definite augmented system.</p><pre><code class="language-julia">model.params.KKT.Factory = Tulip.Factory(LDLFactSQD)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/ldlfact.jl#L8-L18">source</a></section></article><h2 id="Krylov"><a class="docs-heading-anchor" href="#Krylov">Krylov</a><a id="Krylov-1"></a><a class="docs-heading-anchor-permalink" href="#Krylov" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Iterative methods are still an experimental feature. Some numerical and performance issues should be expected.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.KrylovSPD" href="#Tulip.KKT.KrylovSPD"><code>Tulip.KKT.KrylovSPD</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">KrylovSPD{T, F, Tv, Ta}</code></pre><p>Krylov-based <strong>S</strong>ymmetric <strong>P</strong>ositive-<strong>D</strong>efinite (SPD) linear solver.</p><p>Applies a Krylov method to the normal equations systems, then recovers a solution to the augmented system. The selected Krylov method must therefore handle symmetric positive-definite systems. Suitable methods are CG or CR.</p><p>A <code>KrylovSPD</code> is selected as follows</p><pre><code class="language-julia">model.params.KKT.Factory = Tulip.Factory(
    KrylovSPD, method=Krylov.cg,
    atol=1e-12, rtol=1e-12
)</code></pre><p>The <code>method</code> argument is a function <code>f::F</code> whose signature must match</p><pre><code class="language-julia">dy, _ = f(S, ξ; atol, rtol)</code></pre><p>where <code>S</code>, <code>ξ</code> and <code>dy</code> are the normal equations system&#39;s left- and right-hand side, and solution vector, respectively. <code>S</code> may take the form of a matrix, or of a suitable linear operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/krylov.jl#L15-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.KrylovSID" href="#Tulip.KKT.KrylovSID"><code>Tulip.KKT.KrylovSID</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">KrylovSID{T, F, Tv, Ta}</code></pre><p>Krylov-based <strong>S</strong>ymmetric <strong>I</strong>n<strong>D</strong>efinite (SID) linear solver.</p><p>Applies a Krylov method to solve the augmented system, without exploiting its quasi-definiteness properties. The selected Krylov method must therefore handle symmetric indefinite systems. Suitable methods are MINRES or MINRES-QLP.</p><p>A <code>KrylovSID</code> is selected as follows</p><pre><code class="language-julia">model.params.KKT.Factory = Tulip.Factory(
    KrylovSID, method=Krylov.minres,
    atol=1e-12, rtol=1e-12
)</code></pre><p>The <code>method</code> argument is a function <code>f::F</code> whose signature must match</p><pre><code class="language-julia">Δ, _ = f(K, ξ; atol, rtol)</code></pre><p>where <code>K</code>, <code>ξ</code> and <code>Δ</code> are the augmented system&#39;s left- and right-hand side, and solution vector, respectively. <code>K</code> may take the form of a matrix, or of a suitable linear operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/krylov.jl#L154-L179">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Tulip.KKT.KrylovSQD" href="#Tulip.KKT.KrylovSQD"><code>Tulip.KKT.KrylovSQD</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">KrylovSQD{T, F, Tv, Ta}</code></pre><p>Krylov-based <strong>S</strong>ymmetric <strong>Q</strong>uasi-<strong>D</strong>efinite (SQD) linear solver.</p><p>Applies a Krylov method to solve the augmented system, taking advantage of its 2x2 block structure and quasi-definiteness. The selected Krylov method must therefore handle 2x2 symmetric quasi-definite systems. Suitable methods are TriCG and TriMR.</p><p>A <code>KrylovSID</code> is selected as follows</p><pre><code class="language-julia">model.params.KKT.Factory = Tulip.Factory(
    KrylovSQD, method=Krylov.trimr,
    atol=1e-12, rtol=1e-12
)</code></pre><p>The <code>method</code> argument is a function <code>f::F</code> whose signature must match</p><pre><code class="nohighlight">dy, dx, _ = f(A, ξp, ξd; M, N, atol, rtol)</code></pre><p>where the augmented system is of the form</p><pre><code class="nohighlight">[ -N⁻¹ Aᵀ ] [dx] = [ξd]
[  A   M⁻¹] [dy] = [ξp]</code></pre><p>i.e., <span>$N = (Θ^{-1} + R_{p})^{-1}$</span> and <span>$M = R_{d}^{-1}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ds4dm/Tulip.jl/blob/070a9f4dff3bad91bd62fcac11e0b9e84da94df2/src/KKT/krylov.jl#L300-L328">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../Presolve/presolve/">« Presolve</a><a class="docs-footer-nextpage" href="../../API/">Julia API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 26 June 2021 22:58">Saturday 26 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
